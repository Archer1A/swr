# 获取代码<a name="swr_01_0038"></a>

## 操作步骤<a name="section1717719175213"></a>

1.  登录容器镜像服务控制台。
2.  在左侧菜单栏选择“持续交付  \> 流水线“，单击右侧“创建流水线“。

    根据具体场景，选择合适的“镜像构建并部署”或“镜像构建”。

    **表 1** 

    <a name="table615373114422"></a>
    <table><thead align="left"><tr id="row16153123184218"><th class="cellrowborder" valign="top" width="25.06%" id="mcps1.2.3.1.1"><p id="p6153731124216"><a name="p6153731124216"></a><a name="p6153731124216"></a>流水线类型</p>
    </th>
    <th class="cellrowborder" valign="top" width="74.94%" id="mcps1.2.3.1.2"><p id="p12153183115427"><a name="p12153183115427"></a><a name="p12153183115427"></a>说明</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row1153133110427"><td class="cellrowborder" valign="top" width="25.06%" headers="mcps1.2.3.1.1 "><p id="p1715333144214"><a name="p1715333144214"></a><a name="p1715333144214"></a>镜像构建并部署</p>
    </td>
    <td class="cellrowborder" valign="top" width="74.94%" headers="mcps1.2.3.1.2 "><p id="p1186513224417"><a name="p1186513224417"></a><a name="p1186513224417"></a>提供以下几种流水线模板：</p>
    <a name="ul699995912435"></a><a name="ul699995912435"></a><ul id="ul699995912435"><li>基于源码进行编译后构建进项并部署</li><li>基于源码直接构建镜像（无代码编译）</li><li>基于二进制文件构建镜像并部署</li><li>基于二进制文件构建镜像并审核、部署</li><li>（三宝）Package审核发布</li><li>灰度发布模板</li></ul>
    </td>
    </tr>
    <tr id="row51541031124214"><td class="cellrowborder" valign="top" width="25.06%" headers="mcps1.2.3.1.1 "><p id="p1715417310425"><a name="p1715417310425"></a><a name="p1715417310425"></a>镜像构建</p>
    </td>
    <td class="cellrowborder" valign="top" width="74.94%" headers="mcps1.2.3.1.2 "><p id="p1482885914469"><a name="p1482885914469"></a><a name="p1482885914469"></a>提供以下几种流水线模板：</p>
    <a name="ul4701115144720"></a><a name="ul4701115144720"></a><ul id="ul4701115144720"><li>外部jenkins接入</li><li>S2I构建模板</li><li>基于二进制文件构建镜像(不部署)</li><li>基于源码和二进制混合构建镜像(不部署)</li><li>源码管理</li></ul>
    </td>
    </tr>
    </tbody>
    </table>

3.  在“创建流水线”页签，配置流水线信息如[表2](#table14967144191715)所示。

    **表 2**  配置流水线信息

    <a name="table14967144191715"></a>
    <table><thead align="left"><tr id="row10968184471711"><th class="cellrowborder" valign="top" width="25.03%" id="mcps1.2.3.1.1"><p id="p796854420179"><a name="p796854420179"></a><a name="p796854420179"></a>参数名称</p>
    </th>
    <th class="cellrowborder" valign="top" width="74.97%" id="mcps1.2.3.1.2"><p id="p1396816444170"><a name="p1396816444170"></a><a name="p1396816444170"></a>参数配置</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row896864416171"><td class="cellrowborder" valign="top" width="25.03%" headers="mcps1.2.3.1.1 "><p id="p2969124431713"><a name="p2969124431713"></a><a name="p2969124431713"></a>流水线名称</p>
    </td>
    <td class="cellrowborder" valign="top" width="74.97%" headers="mcps1.2.3.1.2 "><p id="p1896914471720"><a name="p1896914471720"></a><a name="p1896914471720"></a>请配置为流水线名称。</p>
    </td>
    </tr>
    <tr id="row12969444101717"><td class="cellrowborder" valign="top" width="25.03%" headers="mcps1.2.3.1.1 "><p id="p1396915444174"><a name="p1396915444174"></a><a name="p1396915444174"></a>流水线组</p>
    </td>
    <td class="cellrowborder" valign="top" width="74.97%" headers="mcps1.2.3.1.2 "><p id="p1526111611256"><a name="p1526111611256"></a><a name="p1526111611256"></a>选择流水线分组。</p>
    <p id="p9969644161717"><a name="p9969644161717"></a><a name="p9969644161717"></a>若无可选流水线组，需要新建流水线组，具体请参见<a href="创建流水线组.md">创建流水线组</a>。</p>
    </td>
    </tr>
    </tbody>
    </table>

4.  单击“确定”，配置代码获取信息如[表3](#table3737102327)所示。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >当前版本代码来源仅支持Gitee、Github、GitLab。  

    此处以GitLab为例进行介绍。

    **表 3**  代码获取信息

    <a name="table3737102327"></a>
    <table><thead align="left"><tr id="row127521011324"><th class="cellrowborder" valign="top" width="33%" id="mcps1.2.3.1.1"><p id="p117581017329"><a name="p117581017329"></a><a name="p117581017329"></a>参数名称</p>
    </th>
    <th class="cellrowborder" valign="top" width="67%" id="mcps1.2.3.1.2"><p id="p117541018328"><a name="p117541018328"></a><a name="p117541018328"></a>参数配置</p>
    </th>
    </tr>
    </thead>
    <tbody><tr id="row15758101328"><td class="cellrowborder" valign="top" width="33%" headers="mcps1.2.3.1.1 "><p id="p187551018323"><a name="p187551018323"></a><a name="p187551018323"></a><span class="keyword" id="keyword8169134319336"><a name="keyword8169134319336"></a><a name="keyword8169134319336"></a>代码来源</span></p>
    </td>
    <td class="cellrowborder" valign="top" width="67%" headers="mcps1.2.3.1.2 "><a name="ol19313973515"></a><a name="ol19313973515"></a><ol id="ol19313973515"><li>单击“绑定账号”，输入GitLab账号并绑定。</li><li>绑定账号后，需要配置以下信息：<a name="ul5212162023717"></a><a name="ul5212162023717"></a><ul id="ul5212162023717"><li>命名空间：配置为代码仓库里的命名空间。</li><li>仓库名称：配置为代码仓库的名称。</li><li>分支：选择“分支”，可配置代码所属的分支。</li><li>标签：选择“标签”，可配置代码对应的标签。</li></ul>
    <div class="note" id="note1651784612462"><a name="note1651784612462"></a><a name="note1651784612462"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p751874684619"><a name="p751874684619"></a><a name="p751874684619"></a>配置“代码来源”前，您需要先注册Gitee/Github/GitLab账号，请参见<a href="绑定源码仓库账号.md">绑定源码仓库账号</a>。</p>
    </div></div>
    </li></ol>
    </td>
    </tr>
    <tr id="row7752010133216"><td class="cellrowborder" valign="top" width="33%" headers="mcps1.2.3.1.1 "><p id="p177516107323"><a name="p177516107323"></a><a name="p177516107323"></a><span class="keyword" id="keyword8756152193317"><a name="keyword8756152193317"></a><a name="keyword8756152193317"></a>自动构建</span></p>
    </td>
    <td class="cellrowborder" valign="top" width="67%" headers="mcps1.2.3.1.2 "><p id="p167512100324"><a name="p167512100324"></a><a name="p167512100324"></a>当满足以下任意条件时，即触发构建：</p>
    <a name="ul18381265402"></a><a name="ul18381265402"></a><ul id="ul18381265402"><li>添加新tag时触发流水线</li><li>提交代码到分支时流水线</li></ul>
    <p id="p61871131184013"><a name="p61871131184013"></a><a name="p61871131184013"></a>请根据实际情况配置。</p>
    </td>
    </tr>
    <tr id="row12771910153210"><td class="cellrowborder" valign="top" width="33%" headers="mcps1.2.3.1.1 "><p id="p1077121011324"><a name="p1077121011324"></a><a name="p1077121011324"></a>全局变量</p>
    </td>
    <td class="cellrowborder" valign="top" width="67%" headers="mcps1.2.3.1.2 "><p id="p577101053219"><a name="p577101053219"></a><a name="p577101053219"></a>请根据实际情况配置。</p>
    <p id="p1583214331452"><a name="p1583214331452"></a><a name="p1583214331452"></a>设置的全局变量可以通过 ${变量名} 的方式，在流水线的配置、脚本中使用。</p>
    <p id="p5256420159"><a name="p5256420159"></a><a name="p5256420159"></a>如：在此处配置环境变量名 reponame，则在上传软件包时，可以使用 ${reponame}来获取值。</p>
    </td>
    </tr>
    </tbody>
    </table>

5.  单击“下一步”，完成代码获取。

